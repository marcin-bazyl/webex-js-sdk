/* globals MediaStream */
import window from 'global/window';

import BrowserDetection from '../common/browser-detection';
import {
  RTC_CONFIGURATION,
  RTC_CONFIGURATION_FIREFOX
} from '../constants';
import LoggerProxy from '../common/logs/logger-proxy';

const {isBrowser} = BrowserDetection();

const MediaUtil = {};
const config = isBrowser('firefox') ? RTC_CONFIGURATION_FIREFOX : RTC_CONFIGURATION;

console.log('marcin: using config: ', config);
MediaUtil.createPeerConnection = () => new window.RTCPeerConnection(
  config
);

MediaUtil.createMediaStream = (tracks) => {
  if (!tracks) {
    LoggerProxy.logger.error('Media:util#createMediaStream --> Tracks don\'t exist');
  }
  const filtredTracks = tracks.filter((element) => !!element);

  return new MediaStream(filtredTracks);
};

export default MediaUtil;
